<!DOCTYPE html>
<html>
  {% include head.html %}

  <body>
    {% include header.html %}

    <div class="page-content">
      <div class="wrapper">
        <div class="home">
          <div style="float: right; text-align: center; margin-left: 20px;">
               <img
                src="{{ page.profile_picture.src | absolute_url }}"
                alt="{{ page.profile_picture.alt }}"
                class="profile-pic"
                />          
                 {% if page.social %}
              <div class="social-links" style="margin-top: 25px; text-align: left; margin-left: 20px;">
                {% for link in page.social %}
                  <div style="margin-bottom: 8px; margin-right: 10px;">
                    <img src="{{ '/assets/img/icons/' | append: link.iconName | append: '.png' | absolute_url }}" 
                         alt="{{ link.iconName }}" 
                         style="width: 20px; height: 20px; vertical-align: middle;" />
                    <a href="{{ link.url }}" target="_blank" style="text-decoration: none; color: #333;">{{ link.name }}</a>
                  </div>
                {% endfor %}
              </div>
            {% endif %} 
          </div>
          <div style="display: flex; flex-direction: column; justify-content: space-between; height: 100%;">
            <div>
              <h1>{{page.title}}</h1>
              <h3 style="color: #666; width: 300px; font-size: 1.5em; font-weight: 500;">{{page.subtitle}}</h3>
            </div>
            <br/>
            <hr/>
            <br/>
            {% if page.techStacks %}
              <div class="tech-stacks" style="margin-bottom: 30px;">
                <h2>Ïä§ÌÇ¨</h2>
                {% for category in page.techStacks %}
                  <div style="margin-bottom: 15px;">
                    <h3 style="color: #666; margin-bottom: 8px;">{{ category.name }}</h3>
                    <div style="display: flex; flex-wrap: wrap; gap: 10px;">
                      {% for tech in category.values %}
                        <span style="background-color: #f5f5f5; padding: 5px 12px; border-radius: 20px; font-size: 0.9em; color: #333;">
                          <b>{{ tech }}</b>
                        </span>
                      {% endfor %}
                    </div>
                  </div>
                {% endfor %}
              </div>
            {% endif %}
          </div>
        </div>
      </div>
    </div>
    
    <div class="page-content">
      <div class="wrapper">
        <div class="page-content-details">
          {{ content }}
        </div>
      </div>
    </div>

    <!-- PDF Ï∂úÎ†• Î≤ÑÌäº -->
    <div style="text-align: center; padding: 20px;">
      <button id="printPDF" style="
        background-color: #007cba;
        color: white;
        border: none;
        padding: 12px 24px;
        font-size: 16px;
        border-radius: 5px;
        cursor: pointer;
        box-shadow: 0 2px 4px rgba(0,0,0,0.2);
      " onmouseover="this.style.backgroundColor='#005a87'" onmouseout="this.style.backgroundColor='#007cba'">
        üìÑ PDFÎ°ú ÎÇ¥Î≥¥ÎÇ¥Í∏∞
      </button>
    </div>

    {% include footer.html %}

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    
    <script>
      document.getElementById('printPDF').addEventListener('click', function() {
        const { jsPDF } = window.jspdf;
        const pdf = new jsPDF('p', 'mm', 'a4');
        
        // Î™®Îì† Ïª®ÌÖêÏ∏†Î•º Ìè¨Ìï®Ìï† ÏöîÏÜåÎì§ÏùÑ ÏÑ†ÌÉù
        const homeContent = document.querySelector('.home');
        const pageContentDetails = document.querySelector('.page-content-details');
        
        let currentYPosition = 10;
        const pageHeight = pdf.internal.pageSize.height;
        const pageWidth = pdf.internal.pageSize.width;
        const margin = 10;
        const maxContentHeight = pageHeight - 2 * margin;
        
        function addSectionToPDF(element) {
          return new Promise((resolve) => {
            html2canvas(element, {
              scale: 2,
              useCORS: true,
              allowTaint: true
            }).then(canvas => {
              const imgData = canvas.toDataURL('image/png');
              const imgWidth = pageWidth - 2 * margin;
              const imgHeight = (canvas.height * imgWidth) / canvas.width;
              
              // ÏÑπÏÖòÏù¥ ÌòÑÏû¨ ÌéòÏù¥ÏßÄÏóê Îì§Ïñ¥Í∞à Ïàò ÏóÜÏúºÎ©¥ ÏÉà ÌéòÏù¥ÏßÄ ÏÉùÏÑ±
              if (currentYPosition + imgHeight > pageHeight - margin) {
                pdf.addPage();
                currentYPosition = margin;
              }
              
              pdf.addImage(imgData, 'PNG', margin, currentYPosition, imgWidth, imgHeight);
              currentYPosition += imgHeight + 2;
              
              resolve();
            });
          });
        }
        
        // Ï≤´ Î≤àÏß∏Î°ú Ìôà ÏÑπÏÖò Ï∂îÍ∞Ä
        addSectionToPDF(homeContent).then(() => {
          
          // ÌéòÏù¥ÏßÄ Ïª®ÌÖêÏ∏†Ïùò ÎÇ¥Ïö©ÏùÑ <br> Í∏∞Ï§ÄÏúºÎ°ú Î∂ÑÎ¶¨ÌïòÏó¨ Ï≤òÎ¶¨
          const contentHTML = pageContentDetails.innerHTML;
          const sections = contentHTML.split('<br>').filter(section => section.trim() !== '');
          
          let sectionIndex = 0;
          
          function procesNextSection() {
            if (sectionIndex >= sections.length) {
              pdf.save('Ìè¨Ìä∏Ìè¥Î¶¨Ïò§.pdf');
              return;
            }
            
            const section = sections[sectionIndex];
            
            // Í∞Å ÏÑπÏÖòÏùÑ ÏûÑÏãú divÏóê ÎÑ£Ïñ¥ÏÑú Î†åÎçîÎßÅ
            const tempDiv = document.createElement('div');
            tempDiv.innerHTML = section;
            tempDiv.style.cssText = `
              position: absolute;
              left: -9999px;
              top: 0;
              width: ${(pageWidth - 2 * margin) * 3.779527559}px;
              font-family: inherit;
              font-size: 14px;
              line-height: 1.6;
              color: #333;
              padding: 10px;
              background: white;
            `;
            document.body.appendChild(tempDiv);
            
            // ÏÑπÏÖò ÎÜíÏù¥ Ï∏°Ï†ï
            html2canvas(tempDiv, {
              scale: 1,
              useCORS: true,
              allowTaint: true
            }).then(canvas => {
              const imgWidth = pageWidth - 2 * margin;
              const imgHeight = (canvas.height * imgWidth) / canvas.width;
              
              // ÏÑπÏÖòÏù¥ ÌéòÏù¥ÏßÄÏóê Îì§Ïñ¥Í∞à Ïàò ÏóÜÏúºÎ©¥ ÏÉà ÌéòÏù¥ÏßÄÎ°ú
              if (currentYPosition + imgHeight > pageHeight - margin) {
                pdf.addPage();
                currentYPosition = margin;
              }
              
              // Í≥†Ìï¥ÏÉÅÎèÑÎ°ú Îã§Ïãú Ï∫°Ï≤ò
              html2canvas(tempDiv, {
                scale: 2,
                useCORS: true,
                allowTaint: true
              }).then(finalCanvas => {
                const finalImgData = finalCanvas.toDataURL('image/png');
                const finalImgWidth = pageWidth - 2 * margin;
                const finalImgHeight = (finalCanvas.height * finalImgWidth) / finalCanvas.width;
                
                pdf.addImage(finalImgData, 'PNG', margin, currentYPosition, finalImgWidth, finalImgHeight);
                currentYPosition += finalImgHeight + 1;
                
                document.body.removeChild(tempDiv);
                sectionIndex++;
                procesNextSection();
              });
            });
          }
          
          procesNextSection();
        });
      });
    </script>

    {% include foot.html %}
  </body>
</html>